'use strict';window.tsfem_ui=function(a){const b=()=>{const b="click.tsfemResetSwitcher";a(window).off(b).on(b,c=>{let d=a(".tsfem-switch-button-container > input[type=\"checkbox\"]:checked");if("undefined"!=typeof d&&0<d.length){let e=d.parents(".tsfem-switch-button-container-wrap");1>a(c.target).closest(e).length&&(d.prop("checked",!1),a(window).off(b))}})},c=(a,b,c,d)=>{var e=Number.parseFloat;if(void 0===a||!a instanceof HTMLElement)return;if(!a.style||!("opacity"in a.style))return;a.style.willChange="opacity",b=b||250,d=!(void 0!==d)||d;let f,g,h,i=0;d?(a.style.opacity=0,a.style.display=null,h=d=>{f=f||d,g=(d-f)/b,i=e(g).toPrecision(2),a.style.opacity=i,1<=i?(a.style.opacity=1,a.style.willChange="auto","function"==typeof c&&c()):(a.style.opacity=i,requestAnimationFrame(h))}):(i=100,h=d=>{f=f||d,g=(d-f)/b,i=e(1-g).toPrecision(2),0>=i?(a.style.opacity=0,a.style.willChange="auto",setTimeout(()=>{a.style.display="none"},0),"function"==typeof c&&c()):(a.style.opacity=i,requestAnimationFrame(h))}),requestAnimationFrame(h)},d=(a,b,d)=>c(a,b,d,!1);let e=!1;const f=(b,c)=>{if(e)return void window.setTimeout(()=>{f(b,c)},500);e=!0;let d=c?1:0;a.ajax({method:"POST",url:ajaxurl,datatype:"json",data:{action:"tsfem_get_dismissible_notice",nonce:tsfem.insecureNonce,"tsfem-notice-key":b,"tsfem-notice-has-msg":d},timeout:7e3,async:!0}).done(b=>{b=tsf.convertJSONResponse(b),tsf.l10n.states.debug&&void 0;let e=b&&b.data||void 0,f=b&&b.type||void 0;if(!e||!f||"undefined"==typeof e.notice);else{let b=e.notice;d&&(b=a(b),window.isRtl?b.find("p").first().prepend(c+" "):b.find("p").first().append(" "+c)),g(b)}}).fail(()=>{tsf.l10n.states.debug&&(void 0,void 0);let a=d?wp.template("tsfem-fbtopnotice-msg"):wp.template("tsfem-fbtopnotice"),e=a({code:b,msg:c});g(e)}).always(()=>{e=!1})},g=b=>{let c=a("#tsfem-notice-wrap"),d=c.children(".tsf-notice, #tsfem-notice-wrap .notice"),e={duration:200,queue:!1};c.css("willChange","contents"),1<d.length&&c.css("maxHeight",c.outerHeight()+"px"),1<d.length&&d.slice(0,d.length-1).each(function(){a(this).slideUp(a.extend(e,{complete:()=>this.remove()}))}),a(b).hide().appendTo(c).slideDown(a.extend(e,{complete:()=>c.css("maxHeight","")})),tsf.triggerNoticeReset()},h=a=>{a=tsf.convertJSONResponse(a)||void 0;let b=a&&a.data||void 0;tsf.l10n.states.debug&&void 0,b&&"results"in b&&"code"in b.results&&f(b.results.code,b.results.notice)},i=()=>{a(".tsfem-switch-button-container-wrap").on("click","label",b)};return Object.assign({load:()=>{document.body.addEventListener("tsf-ready",i)}},{},{fadeIn:c,fadeOut:d,setTopNotice:f,unexpectedAjaxErrorNotice:h,dialog:a=>{let b=a.title||"",e=a.text||"",f=a.select||"",g=a.confirm||"",h=a.cancel||"",j={};if(j.mask=document.createElement("div"),j.mask.className="tsfem-modal-mask",j.maskNoScroll=document.createElement("div"),j.maskNoScroll.className="tsfem-modal-mask-noscroll",j.mask.appendChild(j.maskNoScroll),j.container=document.createElement("div"),j.container.className="tsfem-modal-container",j.dialogWrap=document.createElement("div"),j.dialogWrap.className="tsfem-modal-dialog-wrap",j.dialogWrap.style.marginLeft=document.getElementById("adminmenuwrap").offsetWidth+"px",j.dialogWrap.style.marginTop=document.getElementById("wpadminbar").offsetHeight+"px",j.dialog=document.createElement("div"),j.dialog.className="tsfem-modal-dialog",j.trap=document.createElement("div"),j.trap.className="tsfem-modal-trap",j.trap.tabIndex=0,j.bottomTrap=j.trap.cloneNode(!1),j.dialog.appendChild(j.trap),j.x=document.createElement("div"),j.x.className="tsfem-modal-dismiss",j.x.addEventListener("click",()=>{window.dispatchEvent(new Event("tsfem_modalCancel"))}),j.dialog.appendChild(j.x),b&&(j.titleWrap=document.createElement("div"),j.titleWrap.className="tsfem-modal-title",j.titleWrapTitle=document.createElement("h4"),j.titleWrapTitle.innerHTML=b,j.titleWrap.appendChild(j.titleWrapTitle),j.dialog.appendChild(j.titleWrap)),j.inner=document.createElement("div"),j.inner.className="tsfem-modal-inner",e){if(j.textWrap=document.createElement("div"),j.textWrap.className="tsfem-modal-text",Array.isArray(e))for(let a in e)j.textWrapContent=document.createElement("p"),j.textWrapContent.innerHTML=e[a],j.textWrap.appendChild(j.textWrapContent);else j.textWrapContent=document.createElement("p"),j.textWrapContent.innerHTML=e,j.textWrap.appendChild(j.textWrapContent);j.inner.appendChild(j.textWrap)}let k=!1;if(f){k=!0,j.selectWrap=document.createElement("div"),j.selectWrap.className="tsfem-modal-select";let a={};for(let b in a.wrap=document.createElement("div"),a.wrap.className="tsfem-modal-select-option",a.radio=document.createElement("input"),a.radio.setAttribute("type","radio"),a.radio.setAttribute("name","tsfem-modal-select-option-group"),a.radio.tabIndex=0,a.label=document.createElement("label"),f){let c=a.wrap.cloneNode(!0),d=a.radio.cloneNode(!1),e=a.label.cloneNode(!1);d.setAttribute("value",b),e.innerHTML=f[b],0==b&&(d.checked=!0);let g=`tsfem-dialog-option-${b}`;d.setAttribute("id",g),e.setAttribute("for",g),c.appendChild(d),c.appendChild(e),j.selectWrap.appendChild(c)}j.inner.appendChild(j.selectWrap)}j.dialog.appendChild(j.inner),(g||h)&&(j.buttonWrap=document.createElement("div"),j.buttonWrap.className="tsfem-modal-buttons",g&&(j.confirmButton=document.createElement("button"),j.confirmButton.className="tsfem-modal-confirm tsfem-button-small",j.confirmButton.className+=k?" tsfem-button-primary tsfem-button-primary-bright":" tsfem-button",j.confirmButton.innerHTML=g,j.confirmButton.addEventListener("click",function(){let a;k&&(a={detail:{checked:document.querySelector(".tsfem-modal-select input:checked").value}}),window.dispatchEvent(new CustomEvent("tsfem_modalConfirm",a))}),j.buttonWrap.appendChild(j.confirmButton)),h&&(j.cancelButton=document.createElement("button"),j.cancelButton.className="tsfem-modal-cancel tsfem-button tsfem-button-small",j.cancelButton.innerHTML=h,j.cancelButton.addEventListener("click",()=>{window.dispatchEvent(new Event("tsfem_modalCancel"))}),j.buttonWrap.appendChild(j.cancelButton)),j.dialog.appendChild(j.buttonWrap)),j.dialog.appendChild(j.bottomTrap),j.dialogWrap.appendChild(j.dialog),j.container.appendChild(j.dialogWrap),document.body.appendChild(j.mask),document.body.appendChild(j.container);const l=()=>{j.trap.focus()};j.trap.addEventListener("focus",l),j.bottomTrap.addEventListener("focus",l),j.trap.focus(),c(j.mask),c(j.container);const m=a=>{a.preventDefault()};j.maskNoScroll.addEventListener("wheel",m),j.maskNoScroll.addEventListener("touchmove",m);const n=()=>{j.dialogWrap.style.marginLeft=document.getElementById("adminmenuwrap").offsetWidth+"px",j.dialogWrap.style.marginTop=document.getElementById("wpadminbar").offsetHeight+"px"};window.addEventListener("resize",n);const o=()=>{j.maskNoScroll.removeEventListener("wheel",m),j.maskNoScroll.removeEventListener("touchmove",m),window.removeEventListener("tsfem_modalCancel",o),window.removeEventListener("tsfem_modalConfirm",o),window.removeEventListener("resize",n),d(j.mask,250,()=>j.mask.remove()),d(j.container,250,()=>j.container.remove())};window.addEventListener("tsfem_modalCancel",o),window.addEventListener("tsfem_modalConfirm",o)},logger:(()=>{var a=Math.floor;function b(){i||(i=!0,requestAnimationFrame(d))}function c(){let a=!1;for(let b in g)if(g[b].get("animating")){a=!0;break}return a}function d(b){let h=a(b/(1e3/f));if(h>j)for(let a in g)g[a].get("animating")&&e(a);j=h,c()?requestAnimationFrame(d):i=!1}function e(a){const b=document.getElementById(a);let c=15>b.scrollHeight-b.clientHeight-b.scrollTop;b.innerHTML=g[a].get("queuedlog"),c&&(b.scrollTop=b.scrollHeight)}const f=60,g={},h={trimAt:32767,trimSize:8192};let i=!1,j=-1;return{start:c=>{const d=c.id||=`tsfem-logger-${Date.now().toString(36)}-${a(5e5*Math.random()).toString(36)}`;return g[d]||=new Map,g[d].set("animating",!0),g[d].set("queuedlog",document.getElementById(d).innerHTML),b(),d},stop:a=>{const b=a?.id||a;e(b),g[b].set("animating",!1)},queue:(a,b)=>{const c=a?.id||a;let d=g[c].get("queuedlog")+b;if(d.length>h.trimAt){const a=d.indexOf("\n",h.trimSize);d=d.substring(-1===a?h.trimSize:a)}g[c].set("queuedlog",d)},copy:a=>{const b=document.getElementById(a?.id||a);if(navigator.clipboard)return navigator.clipboard.writeText(b.innerText);else{const a=b.childNodes[0],c=new Range,d=document.getSelection();return c.setStart(a,0),c.setEnd(a,a.length),d.removeAllRanges(),d.addRange(c),new Promise((a,b)=>{try{document.execCommand("copy"),a()}catch(a){b()}d.removeAllRanges()})}},scrollToBottom:a=>{const b=a?.id||a,c=document.getElementById(b);c.scrollTop=c.scrollHeight}}})()})}(jQuery),window.tsfem_ui.load();
