'use strict';window.tsfem_manager=function(a){const b=tsfemManagerL10n.i18n,c=b=>{let c="tsfem-button-disabled",d=a(b.target),e="#tsfem-feed-ajax",f=0;if(d.prop("disabled"))return;d.addClass(c),d.prop("disabled",!0),tsfem.resetAjaxLoader(e),tsfem.setAjaxLoader(e);const g=()=>{d.removeClass(c),d.prop("disabled",!1),tsfem.updatedResponse(e,f,tsfem.i18n.UnknownError)};a.ajax({method:"POST",url:ajaxurl,dataType:"json",data:{action:"tsfem_enable_feeds",nonce:tsfem.nonce},timeout:12e3,async:!0}).done(b=>{var c=Math.round,d=Math.pow;b=tsf.convertJSONResponse(b),tsf.l10n.states.debug&&void 0;let h=b?.data,i=b?.type;if("success"===i&&h){let b=h.content;switch(b.status){case"success":f=1,a(".tsfem-trends-wrap").empty().css("opacity",0).append(b.wrap).animate({opacity:1},{queue:!0,duration:250});let g=400,h=b.data.length,j=0;for(let a=1;a<h-1;a++)j+=c(g/d(1+a/2/100,2));j-=2*g+g/2,a.each(b.data,(b,e)=>{g=c(g/d(1+b/2/100,2)),setTimeout(()=>{a(e).hide().appendTo(".tsfem-feed-wrap").slideDown(g)},g/2*b)}),setTimeout(()=>{tsfem.updatedResponse(e,f,"")},j);break;case"parse_error":case"unknown_error":default:a(".tsfem-trends-wrap").empty().css("opacity",0).append(b.error_output).css("opacity",1).find(".tsfem-feed-wrap").css({opacity:0}).animate({opacity:1},{queue:!0,duration:2e3}),f="unknown_error"===b.status?2:0,setTimeout(()=>{tsfem.updatedResponse(e,f,tsfem.i18n.UnknownError)},1e3);}}else"unknown"===b.type?(f=2,g()):g()}).fail((a,b,f)=>{let g=tsfem.getAjaxError(a,b,f);d.removeClass(c),d.prop("disabled",!1),tsfem.updatedResponse(e,0,g)})},d=c=>{let d="tsfem-button-disabled",f=c.target,g=a(c.target);if(f.disabled||f.classList.contains(d))return;let h=f.dataset.slug,i=f.dataset.case,j="#tsfem-extensions-ajax",k=0,l="",m=0,n="",o=tsfem.getNodeArray(".tsfem-button-extension-activate, .tsfem-button-extension-deactivate",d);o.forEach(a=>{a.classList.add(d),a.disabled=!0}),tsfem.resetAjaxLoader(j),tsfem.setAjaxLoader(j),a.ajax({method:"POST",url:ajaxurl,dataType:"json",data:{action:"tsfem_update_extension",nonce:tsfem.nonce,slug:h,case:i},timeout:1e4,async:!0}).done(a=>{a=tsf.convertJSONResponse(a),tsf.l10n.states.debug&&void 0;let c=a?.data,d=a?.type;if(!c||!d)n=tsfem.i18n.UnknownError;else{let a=c?.results?.code;if(n=c?.results?.notice,"activate"===i)switch(a){case 10001:case 10002:case 10003:case 10004:case 10006:case 10007:case 10013:case 10014:case 10015:k=0,m=a;break;case 10005:k=0,l=c?.fatal_error,m=a;break;case 10008:case 10010:case 10012:k=1,f.classList.remove("tsfem-button","tsfem-button-extension-activate"),f.classList.add("tsfem-button-primary","tsfem-button-primary-dark","tsfem-button-extension-deactivate"),f.dataset.case="deactivate",f.innerText=b.Deactivate;let d=document.getElementById(`${h}-extension-entry`);d&&(d.classList.remove("tsfem-extension-deactivated"),d.classList.add("tsfem-extension-activated")),e(h,i);break;case 10009:k=2,m=a;break;default:k=0,n=tsfem.i18n.UnknownError;}else if("deactivate"===i)switch(a){case 11001:k=1,f.classList.remove("tsfem-button-primary","tsfem-button-primary-dark","tsfem-button-extension-deactivate"),f.classList.add("tsfem-button","tsfem-button-extension-activate"),f.dataset.case="activate",f.innerText=b.Activate;let c=document.getElementById(`${h}-extension-entry`);c&&(c.classList.add("tsfem-extension-deactivated"),c.classList.remove("tsfem-extension-activated")),e(h,i);break;case 11002:case 11003:case 11004:k=0,m=a;break;default:k=0,n=tsfem.i18n.UnknownError;}}}).fail((a,b,c)=>{n=tsfem.getAjaxError(a,b,c),tsfem_ui.setTopNotice(1071100),c&&tsfem_ui.setTopNotice(-1,`Thrown error: ${c}`)}).always(()=>{tsfem.updatedResponse(j,k,n),o.forEach(a=>{a.classList.remove(d),a.disabled=!1}),f.focus(),m&&tsfem_ui.setTopNotice(m,l)})},e=(b,c)=>{a.ajax({method:"POST",url:ajaxurl,dataType:"json",data:{action:"tsfem_update_extension_desc_footer",nonce:tsfem.nonce,slug:b,case:c},timeout:7e3,async:!0}).done(d=>{d=tsf.convertJSONResponse(d),tsf.l10n.states.debug&&void 0;let e=d?.data,f=d?.type;if(!e)return;let g=a(`#${b}-extension-entry .tsfem-extension-description-footer`),h="activate"===c?"up":"down";g.addClass(`tsfem-flip-hide-${h}`),setTimeout(()=>{g.empty().append(e),tsfTT.triggerReset()},250),setTimeout(()=>{g.addClass(`tsfem-flip-show-${h}`)},500),setTimeout(()=>{g.removeClass(`tsfem-flip-hide-${h} tsfem-flip-show-${h}`)},750)}).fail(()=>{tsf.l10n.states.debug&&(void 0,void 0)})},f=()=>{a("#tsfem-enable-feeds").on("click",c),a(".tsfem-button-extension-activate, .tsfem-button-extension-deactivate").on("click",d)};return Object.assign({load:()=>{document.body.addEventListener("tsf-ready",f)}},{i18n:b},{})}(jQuery),window.tsfem_manager.load();
